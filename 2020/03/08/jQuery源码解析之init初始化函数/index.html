<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>jQuery源码解析之init初始化函数 | 夜听风雨知花落</title><meta name="description" content="JQuery源码解析"><meta name="keywords" content="jQuery"><meta name="author" content="夜听风雨知花落"><meta name="copyright" content="夜听风雨知花落"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="jQuery源码解析之init初始化函数"><meta name="twitter:description" content="JQuery源码解析"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg"><meta property="og:type" content="article"><meta property="og:title" content="jQuery源码解析之init初始化函数"><meta property="og:url" content="https://lookmi.github.io/2020/03/08/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Binit%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0/"><meta property="og:site_name" content="夜听风雨知花落"><meta property="og:description" content="JQuery源码解析"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://lookmi.github.io/2020/03/08/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Binit%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0/"><link rel="prev" title="jQuery源码解析之 makeArray 方法" href="https://lookmi.github.io/2020/03/16/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8BmakeArray%E6%96%B9%E6%B3%95/"><link rel="next" title="jQuery源码解析之整体架构" href="https://lookmi.github.io/2020/02/23/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">夜听风雨知花落</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">1</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">1</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#init-初始化函数源码解析"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">init 初始化函数源码解析</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#init-初始化函数源码解析"><span class="toc-number">1.</span> <span class="toc-text">init 初始化函数源码解析</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">jQuery源码解析之init初始化函数</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-03-08<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-08</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/jQuery/">jQuery</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h3 id="init-初始化函数源码解析"><a href="#init-初始化函数源码解析" class="headerlink" title="init 初始化函数源码解析"></a>init 初始化函数源码解析</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rootjQuery,</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* | 前表达式：^(?:\s*(&lt;[\w\W]+&gt;)[^&gt;]* 用来匹配 &lt;p&gt; 形式的html标记标签，前面可加任意空白符，&lt;&gt;内可以是任意字 * 符，最后面除 &gt; 外的任意字符 零次或多次</span></span><br><span class="line"><span class="comment">* \s* : 匹配任何空白字符，包括空格、制表符、换页符等等 零次或多次</span></span><br><span class="line"><span class="comment">* [\w\W]+ : 匹配'[A-Za-z0-9]'一次或多次</span></span><br><span class="line"><span class="comment">* [^&gt;]：除了&gt;的任意字符 零次或多次	</span></span><br><span class="line"><span class="comment">* | 后的表达式：#([\w-]*))$/</span></span><br><span class="line"><span class="comment">* 匹配 以#号开始，结尾是[A-Za-z0-9_-]出现任意次，如 #idExpress。</span></span><br><span class="line"><span class="comment">* 总结:  rquickExpr就是用来匹配html标记标签(如: &lt;p&gt; 或&lt;p&gt;xxx, xxx指任意字符) 或者"#id"(前后不可空白)形	</span></span><br><span class="line"><span class="comment">* 式的表达式</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line">	    </span><br><span class="line"><span class="comment">// rquickExpr正则表达式作用：快速地检测是不是 HTML 或 ID 字符串</span></span><br><span class="line"><span class="comment">// 它包含两个分组，一个匹配HTML字符串、一个匹配ID。</span></span><br><span class="line">rquickExpr = <span class="regexp">/^(?:\s*(&lt;[\w\W]+&gt;)[^&gt;]*|#([\w-]+))$/</span>, </span><br><span class="line">    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* selector：可以是任意类型的值，具体分类如下：</span></span><br><span class="line"><span class="comment">*   1. 可转换成false情况，示例：$(""), $(null), $(undefined), $(false)</span></span><br><span class="line"><span class="comment">*   2. DOM元素，示例：$(DOMElement)</span></span><br><span class="line"><span class="comment">*   3. 字符串</span></span><br><span class="line"><span class="comment">*      - "body"，示例：$('body')</span></span><br><span class="line"><span class="comment">* 	   - "单独标签"，示例：$('&lt;p&gt;')</span></span><br><span class="line"><span class="comment">* 	   - "复杂HTML代码"，示例：$('&lt;p&gt;hah&lt;/p&gt;')</span></span><br><span class="line"><span class="comment">* 	   - "#id"，示例：$('#id')</span></span><br><span class="line"><span class="comment">* 	   - "选择器表达式"，示例：$('ul li')</span></span><br><span class="line"><span class="comment">*   4. 函数，示例：$(function()&#123;&#125;)</span></span><br><span class="line"><span class="comment">*   5. jQuery对象，示例：$($('p'))</span></span><br><span class="line"><span class="comment">*   6. 其他任意类型的值，示例：$(3)，无实际意义</span></span><br><span class="line"><span class="comment">* context：可以是DOM元素、jQuery对象，undefined(不传值)</span></span><br><span class="line"><span class="comment">* root：不传root时，其默认为 rootjQuery 即是 jQuery(document)</span></span><br><span class="line"><span class="comment">*/</span>																									</span><br><span class="line">init = jQuery.fn.init = <span class="function"><span class="keyword">function</span>(<span class="params">selector, context, root</span>) </span>&#123;</span><br><span class="line">			</span><br><span class="line">	<span class="keyword">var</span> match, elem;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// HANDLE: $(""), $(null), $(undefined), $(false)</span></span><br><span class="line">	<span class="comment">// 如果是：空字符串、null、undefined、false，则返回this(空jQuery对象)</span></span><br><span class="line">	<span class="keyword">if</span> (!selector) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;		</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Method init() accepts an alternate rootjQuery</span></span><br><span class="line">    <span class="comment">// so migrate can support jQuery.sub (gh-2101)</span></span><br><span class="line">    <span class="comment">// rootjQuery 获取document对象的jQuery对象</span></span><br><span class="line">    root = root || rootjQuery;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// selector 为字符串</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> selector === <span class="string">"string"</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果 selector 以 &lt;&gt; 开头和结尾且长度大于等于3。</span></span><br><span class="line">        <span class="comment">// 则认为是HTML字符串(&lt;tag&gt;)，跳过regex检查</span></span><br><span class="line">        <span class="comment">// 否则用rquickExpr正则表达式检查这个字符串是否是'#id' 或 HTML字符串</span></span><br><span class="line">        <span class="keyword">if</span> (selector[<span class="number">0</span>] === <span class="string">"&lt;"</span> &amp;&amp;</span><br><span class="line">            selector[selector.length - <span class="number">1</span>] === <span class="string">"&gt;"</span> &amp;&amp;</span><br><span class="line">            selector.length &gt;= <span class="number">3</span>) &#123;</span><br><span class="line"></span><br><span class="line">            match = [<span class="literal">null</span>, selector, <span class="literal">null</span>];</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// exec() 方法用于检索字符串中的正则表达式的匹配。</span></span><br><span class="line">            <span class="comment">// 返回一个数组，其中存放匹配的结果。如果未找到匹配，则返回值为 null。</span></span><br><span class="line">            <span class="comment">// 匹配成功，数组中存放的元素及位置 [selector, HTML或undefined, id或undefined]。</span></span><br><span class="line">            match = rquickExpr.exec(selector);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// match为真(不为空)且match[1] 与 !context 其中一个为真 或 两者都为真</span></span><br><span class="line">        <span class="keyword">if</span> (match &amp;&amp; (match[<span class="number">1</span>] || !context)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// HANDLE: $(html) -&gt; $(array)</span></span><br><span class="line">            <span class="comment">// match[1]是 html字符串(例如：&lt;tag&gt;)</span></span><br><span class="line">            <span class="keyword">if</span> (match[<span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="comment">// 若context存在且为 jQuery 对象时，例如：$('&lt;ul&gt;')是context</span></span><br><span class="line">                <span class="comment">// 此时，context instanceof jQuery 判断结果就为 true</span></span><br><span class="line">                <span class="comment">// 示例：$('&lt;li&gt;', $('&lt;ul&gt;'))，context[0]则是ul</span></span><br><span class="line">                <span class="comment">// 这行代码的作用是将context赋值为原生DOM节点</span></span><br><span class="line">                context = context <span class="keyword">instanceof</span> jQuery ? context[<span class="number">0</span>] : context;</span><br><span class="line">                <span class="comment">// jQuery.merge 用于合并两个数组内容到第一个数组</span></span><br><span class="line">                <span class="comment">// jQuery.parseHTML()用于将HTML字符串解析为对应的DOM节点数组</span></span><br><span class="line">                <span class="comment">// 它有三个参数：详细解释参考官网 https://api.jquery.com/jQuery.parseHTML/</span></span><br><span class="line">                <span class="comment">// data: String类型 需要解析并转为DOM节点数组的HTML字符串</span></span><br><span class="line">                <span class="comment">// context: Element类型 指定在哪个Document中创建元素，默认为当前文档的document</span></span><br><span class="line">                <span class="comment">// keepScripts: Boolean类型 指定传入的HTML字符串中是否包含脚本，默认为false</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 用merge把parseHTML解析成的DOM节点数组，合并到jQuery对象</span></span><br><span class="line">                jQuery.merge(<span class="keyword">this</span>, jQuery.parseHTML(</span><br><span class="line">                    match[<span class="number">1</span>],</span><br><span class="line">                    <span class="comment">// nodeType 属性返回一个整数，其代表的是节点类型</span></span><br><span class="line">                    context &amp;&amp; context.nodeType ? context.ownerDocument || context : <span class="built_in">document</span>,</span><br><span class="line">                    <span class="literal">true</span></span><br><span class="line">                ));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// HANDLE: $(html, props) 解释如下：</span></span><br><span class="line">                <span class="comment">// 根据提供的原始HTML标记字符串，动态创建由jQuery对象包装的DOM元素并设置一系列的属性、事件等</span></span><br><span class="line">                <span class="comment">// 说的直白点：就是动态创建HTML标记时，给其加上属性事件</span></span><br><span class="line">                <span class="comment">// 示例: </span></span><br><span class="line">                <span class="comment">// $("&lt;p/&gt;", &#123;"class": "test", "text": "Click me!",</span></span><br><span class="line">                <span class="comment">//	 click: function() &#123;</span></span><br><span class="line">                <span class="comment">//		$(this).toggleClass("main");</span></span><br><span class="line">                <span class="comment">//	 &#125;</span></span><br><span class="line">                <span class="comment">//  &#125;).appendTo("body");</span></span><br><span class="line">	</span><br><span class="line">                <span class="comment">// $.isPlainObject() 函数用于判断指定参数是否是一个纯粹的对象。</span></span><br><span class="line">                <span class="comment">// rsingleTag验证match[1]是一个单独的标签且context是一个纯粹的对象(动态创建html并传入个                   // json对象时触发)</span></span><br><span class="line">                <span class="keyword">if</span> (rsingleTag.test(match[<span class="number">1</span>]) &amp;&amp; jQuery.isPlainObject(context)) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (match <span class="keyword">in</span> context) &#123;</span><br><span class="line">                        <span class="comment">// 循环context这个json对象，并判断它的属性是否是jQuery自带的方法</span></span><br><span class="line">                        <span class="comment">// 如果是，则直接调用，否则，用jQuery的attr方法为这个标签加一个match属性。</span></span><br><span class="line">                        <span class="comment">// Properties of context are called as methods if possible</span></span><br><span class="line">                        <span class="keyword">if</span> (isFunction(<span class="keyword">this</span>[match])) &#123;</span><br><span class="line">                            <span class="keyword">this</span>[match](context[match]);</span><br><span class="line"></span><br><span class="line">                            <span class="comment">// ...and otherwise set as attributes</span></span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">this</span>.attr(match, context[match]);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// HANDLE: $(#id)</span></span><br><span class="line">                <span class="comment">// 字符串为id</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 查找match[2]这个Id的DOM元素</span></span><br><span class="line">                elem = <span class="built_in">document</span>.getElementById(match[<span class="number">2</span>]);</span><br><span class="line">                <span class="comment">// 判断 elem 是否存在</span></span><br><span class="line">                <span class="keyword">if</span> (elem) &#123;</span><br><span class="line">                    <span class="comment">// Inject the element directly into the jQuery object</span></span><br><span class="line">                    <span class="comment">// 将元素直接注入jQuery对象</span></span><br><span class="line">                    <span class="keyword">this</span>[<span class="number">0</span>] = elem;</span><br><span class="line">                    <span class="keyword">this</span>.length = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>; <span class="comment">// 返回当前对象</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// HANDLE: $(expr, $(...)) </span></span><br><span class="line">            <span class="comment">// 如果字符串是选择器表达式 </span></span><br><span class="line">            <span class="comment">// contex存在且是jQuery对象，例如：$('li', $(document))</span></span><br><span class="line">            <span class="comment">// 返回context.find(selector)，否则，返回root.find(selector)</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!context || context.jquery) &#123;</span><br><span class="line">            <span class="keyword">return</span> (context || root).find(selector);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// HANDLE: $(expr, context)</span></span><br><span class="line">            <span class="comment">// (which is just equivalent to: $(context).find(expr)</span></span><br><span class="line">            <span class="comment">// 如果指定了上下文，但其不是jQuery对象 例如：$('li', 'ul')			</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 下面这行代码，就是先创建一个包含了context的jQuery对象，然后在该对象上调用find()方法。</span></span><br><span class="line">            <span class="comment">// 它等价与: $(context).find(selector)</span></span><br><span class="line">            <span class="comment">// this: 指当前jQuery对象，其constructor是jQuery，即this.constructor就是jQuery</span></span><br><span class="line">            <span class="comment">// 那么this.constructor(context)即是jQuery(context)</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.constructor(context).find(selector);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// HANDLE: $(DOMElement)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果selector.nodeType为真，selector则是HTML DOM(文档对象模型)中的节点</span></span><br><span class="line">        <span class="comment">// 示例：document.getElementById() 可获取HTML的元素节点</span></span><br><span class="line">        <span class="comment">// nodeType属性返回节点类型(详解请参考菜鸟教程) 1: 元素节点 2: 属性节点 </span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (selector.nodeType) &#123;</span><br><span class="line">        <span class="keyword">this</span>[<span class="number">0</span>] = selector;</span><br><span class="line">        <span class="keyword">this</span>.length = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>; </span><br><span class="line"></span><br><span class="line">        <span class="comment">// HANDLE: $(function)</span></span><br><span class="line">        <span class="comment">// Shortcut for document ready</span></span><br><span class="line">        <span class="comment">// 如果 selector 是函数</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(selector)) &#123;</span><br><span class="line">        <span class="comment">// root默认是 jQuery(document)，所以root.ready(selector)</span></span><br><span class="line">        <span class="comment">// 就是 $(document).ready(function() &#123;&#125;)</span></span><br><span class="line">        <span class="keyword">return</span> root.ready !== <span class="literal">undefined</span> ?</span><br><span class="line">            root.ready(selector) :</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Execute immediately if ready is not present</span></span><br><span class="line">        selector(jQuery); <span class="comment">// 这是一个自执行匿名函数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// selector是任意值(例如：数组或伪数组（如jQuery对象）)时，则会被添加到当前jQuery对象中 </span></span><br><span class="line">    <span class="comment">// makeArray() 函数可以把一个类似数组的对象转换为真正的数组对象  </span></span><br><span class="line">    <span class="keyword">return</span> jQuery.makeArray(selector, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize central reference</span></span><br><span class="line">rootjQuery = jQuery(<span class="built_in">document</span>);</span><br></pre></td></tr></table></figure></div></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">夜听风雨知花落</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lookmi.github.io/2020/03/08/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Binit%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0/">https://lookmi.github.io/2020/03/08/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Binit%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lookmi.github.io">夜听风雨知花落</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/jQuery/">jQuery    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.0/img/wechat.png" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.0/img/alipay.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/03/16/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8BmakeArray%E6%96%B9%E6%B3%95/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>jQuery源码解析之 makeArray 方法</span></div></a></div><div class="next-post pull_right"><a href="/2020/02/23/jQuery%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>jQuery源码解析之整体架构</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/03/16/jQuery源码解析之makeArray方法/" title="jQuery源码解析之 makeArray 方法"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-16</div><div class="relatedPosts_title">jQuery源码解析之 makeArray 方法</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/23/jQuery源码解析之整体架构/" title="jQuery源码解析之整体架构"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/lookmi/jsDelivr@1.1/img/study.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-23</div><div class="relatedPosts_title">jQuery源码解析之整体架构</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 夜听风雨知花落</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>